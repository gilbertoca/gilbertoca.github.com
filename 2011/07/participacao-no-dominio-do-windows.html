<!DOCTYPE html>
<html lang="pt_BR">
    <head>
        <title></title>
        <meta charset="utf-8"/>
        <title>Linux - Participação no domínio do Windows </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">

        <link href="http://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet" type="text/css">
        <link rel="alternate"  type="application/atom+xml" title="Vivendo e Aprendendo (Atom)" href="/feed.xml" />
        <link href="../../css/default.css" rel="stylesheet">
        <link href="../../css/syntax.css" rel="stylesheet">
        <link href="../../css/prettify.css" rel="stylesheet">

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
          <script src="../../js/html5shiv.min.js"></script>
        <![endif]-->

        <!-- Fav and touch icons -->
        <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
        <link rel="shortcut icon" href="../../favicon.ico">
    </head>
    <body onload="prettyPrint()">
	
<header>
	<hgroup>
		<h1><a href="/">Vivendo e Aprendendo</a></h1>
		<h2>Experiência prática na administração de Banco de Dados</h2>
	</hgroup>
</header>
<nav>
<menu>
	<a href="../../index.html">Home</a>
	<a href="../../archive.html">All posts</a>
	<a href="../../about.html">About me</a>
	<a href="../../feeds/posts/default.xml">Atom feed</a>
	</menu>
</nav>
<section>
<article>
    <header>
        <h1>Linux - Participação no domínio do Windows </h1>
        <p>by <em>Gilberto C. Andrade</em> on <strong>15 Julho 2011</strong></p>
        <p>Tagged as: 
            <a href="../../tags/Active Directory.html">Active Directory</a>,
            <a href="../../tags/configuração.html">configuração</a>,
            <a href="../../tags/kerberos.html">kerberos</a>,
            <a href="../../tags/Linux.html">Linux</a>,
            <a href="../../tags/opensuse.html">opensuse</a>,
            <a href="../../tags/Sistema Operacional.html">Sistema Operacional</a>,
            <a href="../../tags/Windows.html">Windows</a>,
        </p>
    </header>
    <section>
	<!-- google_ad_section_start -->
<blockquote><p>Eu não quero compartilhar aquivo nenhum, apenas quero me logar no dominio MS, para assim usar internet, e-mail, enfim tudo que uma estação d trabalho com XP faria quando ngressa no dominio!<br/>Eu não quero criar um server com samba sem ser PDC E deixar na rede, quero apenas ao inves de usar o XP como estação de trabalho usar o openSUSE! </p>
</blockquote><p>Este pedido de ajuda está registrado &lt;a href=&ldquo;<a href="http://www.vivaolinux.com.br/topico/Suse/Linux-em-dominio-Windows">http://www.vivaolinux.com.br/topico/Suse/Linux-em-dominio-Windows</a>&rdquo; title:&ldquo;Linux em dominio Windows&rdquo; target=&quot;_blank&quot;&gt;aqui</a> na comunidade <a href="http://www.vivaolinux.com.br/" title="Viva o Linux" target="_blank">vivaolinux</a>. </p><p>Apesar de ser uma discussão antiga, ainda assim é bom fazer um passo a passo deste procedimento. Antes devo relatar que aqui na secretaria usamos &lt;a href=&ldquo;<a href="http://technet.microsoft.com/pt-br/library/cc668412.aspx">http://technet.microsoft.com/pt-br/library/cc668412.aspx</a>&rdquo; title:&ldquo;Active Directory&rdquo; target=&quot;_blank&quot;&gt;Active Directory</a> para autenticação, então foi esse ambiente que usei para testar a inclusão de uma estação <a href="http://pt.opensuse.org/Portal:Distribui%C3%A7%C3%A3o" title="OpenSUSE" target="_blank">Linux OpenSUSE</a> em um Domínio Windows: </p>
<ol>
  <li>Registrar seu controlador de domínio(DC) na lista de nomes de máquinas. Adicione todo o nome qualificado primeiro e o apelido como alias: 192.168.1.2 = server.domain.com server<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/1-register_domain_controler_machine_hosts.png"><img src="http://blog.gilbertoca.com/img/uploads/1-register_domain_controler_machine_hosts.png"  title="1-register_domain_controler_machine_hosts" width="1024" height="768" class="alignright size-full wp-image-769" /></a></li>
  <li>Editar o arquivo /etc/resolv.conf e adicionar seu DC como nameserver: nameserver = server.domain.com<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/2-edit_etc_resolver_conf_add_DC_as_nameserver.png"><img src="http://blog.gilbertoca.com/img/uploads/2-edit_etc_resolver_conf_add_DC_as_nameserver.png"  title="2-edit_etc_resolver_conf_add_DC_as_nameserver" width="1024" height="768" class="alignright size-full wp-image-770" /></a></li>
  <li>Configure o kerberos através do yast: o realm deverá ser escrito em letra maiúscula: DOMAIN.COM<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/3-configure_kerberos_capitalletters_for_DC.png"><img src="http://blog.gilbertoca.com/img/uploads/3-configure_kerberos_capitalletters_for_DC.png"  title="3-configure_kerberos_capitalletters_for_DC" width="1024" height="768" class="alignright size-full wp-image-771" /></a></li>
  <li><p><p>Configura o samba<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/4-samba_DC_none_workgroupname_domain_security_ads_realms.png"><img src="http://blog.gilbertoca.com/img/uploads/4-samba_DC_none_workgroupname_domain_security_ads_realms.png"  title="4-samba_DC_none_workgroupname_domain_security_ads_realms" width="1024" height="768" class="alignright size-full wp-image-772" /></a></p> <div class="wp_syntax"><br/> <table><br/> <tr><br/> <td class="code"><br/> <pre class="vim" style="font-family:monospace;">SUGEP265338<span style="color: #000000;">:~</span> # <span style="color: #668080;">more</span> <span style="color: #000000;">/</span>etc<span style="color: #000000;">/</span>samba<span style="color: #000000;">/</span>smb<span style="color: #000000;">.</span>conf </p><h1>smb<span style="color: #000000;">.</span>conf <span style="color: #668080;">is</span> the main Samba configuration file<span style="color: #000000;">.</span> You find a full commented</h1><h1>version at <span style="color: #000000;">/</span>usr<span style="color: #000000;">/</span>share<span style="color: #000000;">/</span>doc<span style="color: #000000;">/</span>packages<span style="color: #000000;">/</span>samba<span style="color: #000000;">/</span>examples<span style="color: #000000;">/</span>smb<span style="color: #000000;">.</span>conf<span style="color: #000000;">.</span>SUSE <span style="color: #804040;">if</span> the</h1><h1>samba<span style="color: #000000;">-</span>doc package <span style="color: #668080;">is</span> installed<span style="color: #000000;">.</span></h1><h1>Date<span style="color: #000000;">:</span> <span style="color: #000000; font-weight:bold;">2011</span><span style="color: #000000;">-</span><span style="color: #000000; font-weight:bold;">11</span><span style="color: #000000;">-</span>02</h1><span style="color: #000000;">&#91;</span>global<span style="color: #000000;">&#93;</span><br/><span style="color: #25BB4D;">add</span> machine script = <span style="color: #000000;">/</span>usr<span style="color: #000000;">/</span>sbin<span style="color: #000000;">/</span>useradd <span style="color: #000000;">-</span>c Machine <span style="color: #000000;">-</span>d <span style="color: #000000;">/</span>var<span style="color: #000000;">/</span>lib<span style="color: #000000;">/</span>nobody <span style="color: #000000;">-</span>s <span style="color: #000000;">/</span><span style="color: #668080;">bin</span><span style="color: #000000;">/</span>false <span style="color: #000000;">%</span>m<span style="color: #000000;">$</span><br/>domain master = No<br/>security = ADS<br/>workgroup = ADMINISTRACAO<br/>realm = ADMINISTRACAO<span style="color: #000000;">.</span>LOCAL<br/>idmap gid = <span style="color: #000000; font-weight:bold;">10000</span><span style="color: #000000;">-</span><span style="color: #000000; font-weight:bold;">20000</span><br/>idmap uid = <span style="color: #000000; font-weight:bold;">10000</span><span style="color: #000000;">-</span><span style="color: #000000; font-weight:bold;">20000</span><br/>usershare allow guests = No<br/>template homedir = <span style="color: #000000;">/</span>home<span style="color: #000000;">/%</span>D<span style="color: #000000;">/%</span>U<br/>winbind refresh tickets = yes<br/>template <span style="color: #668080;">shell</span> = <span style="color: #000000;">/</span><span style="color: #668080;">bin</span><span style="color: #000000;">/</span>bash<br/><span style="color: #000000;">&#91;</span>homes<span style="color: #000000;">&#93;</span><br/>comment = Home Directories<br/>valid users = <span style="color: #000000;">%</span>S, <span style="color: #000000;">%</span>D<span style="color: #000000;">%</span>w<span style="color: #000000;">%</span>S<br/>browseable = No<br/>read only = No<br/>inherit acls = Yes<br/><span style="color: #000000;">&#91;</span>profiles<span style="color: #000000;">&#93;</span><br/><span style="color: #000000;">&ndash;</span>More<span style="color: #000000;">&ndash;</span><span style="color: #000000;">&#40;</span><span style="color: #000000; font-weight:bold;">51</span><span style="color: #000000;">%</span><span style="color: #000000;">&#41;</span></pre><br/> </td><br/> </tr><br/> </table><br/></div></p><p>Não esqueça de reiniciar os serviços<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/5-restart_samba_server.png"><img src="http://blog.gilbertoca.com/img/uploads/5-restart_samba_server.png"  title="5-restart_samba_server" width="1024" height="768" class="alignright size-full wp-image-773" /></a> </li> </p>
  <ul>
    <li>Adicionar a máquina ao domínio (neste momento utilizando o kerberos)<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/6-test_kerberos_autentication.png"><img src="http://blog.gilbertoca.com/img/uploads/6-test_kerberos_autentication.png"  title="6-test_kerberos_autentication" width="1024" height="768" class="alignright size-full wp-image-774" /></a></p><br/>net ads join -U Administrador<br/><a href="http://blog.gilbertoca.com/http://blog.gilbertoca.com/img/uploads/7-join_ads_domain.png"><img src="http://blog.gilbertoca.com/img/uploads/7-join_ads_domain.png"  title="7-join_ads_domain" width="1024" height="768" class="alignright size-full wp-image-775" /></a> </li></li>
  </ul>
  <pre><code>  * Adicionar a máquina ao domínio (agora utilizando o samba): no yast use a opção:”Participação no domínio do windows”, marcando a opção “Usar informação SMB para autenticação Linux”  
    [&lt;img src=&quot;http://blog.gilbertoca.com/img/uploads/8-windows_domain_membership.png&quot;  title=&quot;8-windows_domain_membership&quot; width=&quot;1024&quot; height=&quot;768&quot; class=&quot;alignright size-full wp-image-776&quot; /&gt;][8] 
  * Reinicie a máquina  
    [&lt;img src=&quot;http://blog.gilbertoca.com/img/uploads/9-reboot_linux_client.png&quot;  title=&quot;9-reboot_linux_client&quot; width=&quot;1024&quot; height=&quot;768&quot; class=&quot;alignright size-full wp-image-777&quot; /&gt;][9] &lt;/ol&gt; 

Use com moderação! &lt;img src=&quot;http://blog.gilbertoca.com/wp-includes/images/smilies/icon_smile.gif&quot; alt=&quot;:)&quot; class=&quot;wp-smiley&quot; /&gt; 

&lt;!-- google_ad_section_end --&gt;
</code></pre></li>
</ol>
    </section>
<section>
<div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'blog-gilbertoca-com';
            var disqus_identifier = '764';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
</article>
	
</section>
<footer>
	<p>
		<a href="https://pages.github.com/">Hosted by GitHub Pages</a> -
		<a href="http://jbake.org/">Generated with JBake</a> -
		<a href="http://github.com/gilbertoca/gilbertoca.com">Source code</a>
	</p>
</footer>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-2586578-2']);
	_gaq.push(['_trackPageview']);
	(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body>
</html>
